-- Servicios
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local SoundService = game:GetService("SoundService")
local VoiceChatService = game:GetService("VoiceChatService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local root = character:WaitForChild("HumanoidRootPart")

-- Shiftlock variables
local shiftlockEnabled = false
local shiftlockKeybind = Enum.KeyCode.Q
local isActive = false
local cameraConnection = nil

-- GUI Shiftlock
local ShiftlockGui = Instance.new("ScreenGui")
ShiftlockGui.Name = "ShiftlockGUI"
ShiftlockGui.ResetOnSpawn = false
ShiftlockGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ShiftlockGui.Parent = player:WaitForChild("PlayerGui")

local Button = Instance.new("ImageButton")
Button.Name = "ShiftlockButton"
Button.Parent = ShiftlockGui
Button.BackgroundTransparency = 1
Button.Size = UDim2.new(0.0636, 0, 0.0661, 0)
Button.Position = UDim2.new(0.9219, 0, 0.5523, 0)
Button.SizeConstraint = Enum.SizeConstraint.RelativeXX
Button.Visible = false

local StateLabelFrame = Instance.new("Frame")
StateLabelFrame.Parent = Button
StateLabelFrame.Size = UDim2.new(1, 0, 1, 0)
StateLabelFrame.BackgroundTransparency = 0.5
StateLabelFrame.BackgroundColor3 = Color3.new(0, 0, 0)

local StateLabel = Instance.new("TextLabel")
StateLabel.Parent = StateLabelFrame
StateLabel.Size = UDim2.new(1, 0, 1, 0)
StateLabel.BackgroundTransparency = 1
StateLabel.Text = "OFF"
StateLabel.TextColor3 = Color3.new(1, 1, 1)
StateLabel.TextScaled = true
StateLabel.Font = Enum.Font.SourceSansBold

local Crosshair = Instance.new("TextLabel")
Crosshair.Parent = ShiftlockGui
Crosshair.Size = UDim2.new(0, 30, 0, 30)
Crosshair.Position = UDim2.new(0.5, -15, 0.5, -15)
Crosshair.BackgroundTransparency = 1
Crosshair.Text = "O"
Crosshair.TextScaled = true
Crosshair.TextColor3 = Color3.new(1, 1, 1)
Crosshair.Visible = false

-- Funciones Shiftlock
local function UpdateImage(state)
	StateLabel.Text = state
end

local function UpdateAutoRotate(state)
	if humanoid then
		humanoid.AutoRotate = state
	end
end

local function AnimateButtonPress()
	local tweenInfo = TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	local shrinkSize = Button.Size - UDim2.new(0.01, 0, 0.01, 0)
	local tweenShrink = TweenService:Create(Button, tweenInfo, { Size = shrinkSize })
	local tweenGrow = TweenService:Create(Button, tweenInfo, { Size = UDim2.new(0.0636, 0, 0.0661, 0) })
	tweenShrink:Play()
	tweenShrink.Completed:Connect(function()
		tweenGrow:Play()
	end)
end

local function ShiftLockToggle()
	if not ((camera.CameraSubject == humanoid or camera.CameraSubject == root) and camera.CameraType == Enum.CameraType.Custom) then
		return
	end

	AnimateButtonPress()

	if not isActive then
		isActive = true
		UpdateAutoRotate(false)
		UpdateImage("ON")
		Crosshair.Visible = true
		UserInputService.MouseIconEnabled = false
		UserInputService.MouseBehavior = Enum.MouseBehavior.LockCenter

		cameraConnection = RunService.RenderStepped:Connect(function()
			if character and root and camera then
				local direction = camera.CFrame.LookVector
				local flatDirection = Vector3.new(direction.X, 0, direction.Z)
				if flatDirection.Magnitude > 0 then
					root.CFrame = CFrame.new(root.Position, root.Position + flatDirection)
				end
			end
		end)
	else
		isActive = false
		UpdateAutoRotate(true)
		UpdateImage("OFF")
		Crosshair.Visible = false
		UserInputService.MouseIconEnabled = true
		UserInputService.MouseBehavior = Enum.MouseBehavior.Default

		if cameraConnection then
			cameraConnection:Disconnect()
			cameraConnection = nil
		end
	end
end

player.CharacterAdded:Connect(function(char)
	character = char
	humanoid = character:WaitForChild("Humanoid")
	root = character:WaitForChild("HumanoidRootPart")
	if isActive then
		UpdateAutoRotate(false)
	end
end)

Button.MouseButton1Click:Connect(function()
	if shiftlockEnabled then
		ShiftLockToggle()
	end
end)

UserInputService.InputBegan:Connect(function(input, gp)
	if gp then return end
	if not UserInputService.TouchEnabled and shiftlockEnabled and input.KeyCode == shiftlockKeybind then
		ShiftLockToggle()
	end
end)

UpdateImage("OFF")

-- Toggle Shiftlock
MainTab:CreateToggle({
	Name = "Shiftlock Q para activar",
	CurrentValue = false,
	Flag = "ShiftlockToggle",
	Callback = function(Value)
		shiftlockEnabled = Value
		Button.Visible = shiftlockEnabled and UserInputService.TouchEnabled
		if not shiftlockEnabled and isActive then
			isActive = false
			UpdateAutoRotate(true)
			UpdateImage("OFF")
			Crosshair.Visible = false
			UserInputService.MouseIconEnabled = true
			UserInputService.MouseBehavior = Enum.MouseBehavior.Default
			if cameraConnection then
				cameraConnection:Disconnect()
				cameraConnection = nil
			end
		end
	end
})

-- Caminar en el aire
local isWalkingInAir = false
local floorPart = nil
local heartbeatConnection = nil

local function isTouchingGround()
	local ray = Ray.new(root.Position, Vector3.new(0, -5, 0))
	local hitPart = workspace:FindPartOnRay(ray, character)
	return hitPart and hitPart.CanCollide
end

local function createFloor()
	if not floorPart then
		floorPart = Instance.new("Part")
		floorPart.Size = Vector3.new(50, 1, 50)
		floorPart.Anchored = true
		floorPart.CanCollide = true
		floorPart.Transparency = 1
		floorPart.Parent = workspace
	end
end

MainTab:CreateToggle({
	Name = "Caminar en el aire",
	CurrentValue = isWalkingInAir,
	Flag = "walkInAirToggle",
	Callback = function(Value)
		isWalkingInAir = Value

		if isWalkingInAir then
			createFloor()
			if not heartbeatConnection then
				heartbeatConnection = RunService.Heartbeat:Connect(function()
					if isWalkingInAir and floorPart and not isTouchingGround() then
						floorPart.Position = root.Position - Vector3.new(0, 3, 0)
					end
				end)
			end
		else
			if floorPart then
				floorPart:Destroy()
				floorPart = nil
			end
			if heartbeatConnection then
				heartbeatConnection:Disconnect()
				heartbeatConnection = nil
			end
		end
	end,
})

-- Mutear sonidos excepto voz
local mutedSounds = {}
local toggleActive = false

local function isVoiceSound(sound)
	if sound:IsDescendantOf(VoiceChatService) then return true end
	local name = sound.Name:lower()
	return name:find("voice") or name:find("vc")
end

local function muteAllExceptVoice()
	for _, sound in ipairs(game:GetDescendants()) do
		if sound:IsA("Sound") and not isVoiceSound(sound) then
			if sound.Playing and sound.Volume > 0 then
				mutedSounds[sound] = sound.Volume
				sound.Volume = 0
			end
		end
	end
end

local function unmuteAll()
	for sound, vol in pairs(mutedSounds) do
		if sound and sound.Parent then
			sound.Volume = vol
		end
	end
	mutedSounds = {}
end

game.DescendantAdded:Connect(function(sound)
	if toggleActive and sound:IsA("Sound") and not isVoiceSound(sound) then
		mutedSounds[sound] = sound.Volume
		sound.Volume = 0
	end
end)

MainTab:CreateToggle({
	Name = "Mutear sonidos (voz no)",
	CurrentValue = false,
	Flag = "MuteAudios",
	Callback = function(Value)
		toggleActive = Value
		if Value then
			muteAllExceptVoice()
		else
			unmuteAll()
		end
	end
})




---Fullbright

local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local originalSettings = {}
local connection

MainTab:CreateToggle({
	Name = "Fullbright",
	Flag = "Fullbright",
	CurrentValue = false,
	Callback = function(enabled)
		if enabled then
			-- Guardar valores originales
			originalSettings.Brightness = Lighting.Brightness
			originalSettings.ClockTime = Lighting.ClockTime
			originalSettings.Ambient = Lighting.Ambient
			originalSettings.OutdoorAmbient = Lighting.OutdoorAmbient
			originalSettings.GlobalShadows = Lighting.GlobalShadows

			-- Conexión para forzar iluminación
			if not connection then
				connection = RunService.RenderStepped:Connect(function()
					Lighting.Brightness = 1.5
					Lighting.ClockTime = 12
					Lighting.Ambient = Color3.new(1, 1, 1)
					Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
					Lighting.GlobalShadows = false
				end)
			end
		else
			-- Restaurar valores
			if connection then
				connection:Disconnect()
				connection = nil
			end
			for prop, value in pairs(originalSettings) do
				Lighting[prop] = value
			end
		end
	end
})









